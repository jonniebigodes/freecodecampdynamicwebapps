'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var unirest=require('unirest'),yelp=require('yelp-fusion'),getStockInformation=exports.getStockInformation=function(a){var b={error:!1,messageError:'',dataRecieved:{}},c={stockName:'',stockCode:'',refreshDate:'',stockQueryStart:'',StockQueryEnd:'',stockData:[]};return new Promise(function(d,e){try{unirest.get('https://www.quandl.com/api/v3/datasets/WIKI/'+a.queryStock+'.json').query({api_key:a.keyQuandl}).query({start_date:a.startDate}).query({end_date:a.endDate}).end(function(f){if(404===f.status)b.error=!0,e(b);else{c.stockName=f.body.dataset.name,c.stockCode=f.body.dataset.dataset_code,c.refreshDate=f.body.dataset.refreshed_at,c.stockQueryStart=a.startDate,c.StockQueryEnd=a.endDate;for(var g=0;g<f.body.dataset.data.length;g++)c.stockData.push({stockDate:f.body.dataset.data[g][0],openPrice:f.body.dataset.data[g][1],highestPrice:f.body.dataset.data[g][2],lowestPrice:f.body.dataset.data[g][3],closePrice:f.body.dataset.data[g][4]});b.dataRecieved=c,d(b)}})}catch(a){console.log('ERROR HTTP SERVICE:\n'+a),b.error=!0,b.messageError='ERROR ON PROCESSING REQUEST TO STOCK SERVER: '+a,e(b)}})},getToken=exports.getToken=function(a,b){var c={error:!1,messageError:'',dataRecieved:{}};return new Promise(function(d,f){try{yelp.accessToken(a,b).then(function(a){d(a.jsonBody.access_token)}).catch(function(a){console.log('===================================='),console.log('there was an error getting the goken:\n '+a),console.log('===================================='),c.error=!0,c.messageError=a,f(c)})}catch(a){console.log('ERROR HTTP SERVICE YELP TOKEN:\n'+a),c.error=!0,c.messageError='ERROR ON PROCESSING REQUEST TO YELP SERVER: '+a,f(c)}})},searchYelp=exports.searchYelp=function(a,b,c,d){var f={error:!1,messageError:'',dataRecieved:{}},e=[];return new Promise(function(g,h){try{var i=yelp.client(a);i.search({term:b,location:c,limit:d}).then(function(a){for(var b,c=0;c<a.jsonBody.businesses.length;c++)b={},a.jsonBody.businesses[c].is_closed||(b.id=a.jsonBody.businesses[c].id,b.name=a.jsonBody.businesses[c].name,b.img=a.jsonBody.businesses[c].image_url,b.url=a.jsonBody.businesses[c].url,b.address=a.jsonBody.businesses[c].location.address1,b.city=a.jsonBody.businesses[c].location.city,b.zipCode=a.jsonBody.businesses[c].location.zip_code,b.isGoing=!1,a.jsonBody.businesses[c].categories[0]&&(b.category=a.jsonBody.businesses[c].categories[0].alias),e.push(b));f.dataRecieved.num_items_response=a.jsonBody.businesses.length,f.dataRecieved.results=e,g(f)}).catch(function(a){console.log('===================================='),console.log('ERROR ON PROCESSING REQUEST TO YELP SERVER:'+a),console.log('===================================='),f.error=!0,f.messageError='ERROR ON PROCESSING REQUEST TO YELP SERVER: '+a,h(f)})}catch(a){console.log('ERROR HTTP SERVICE YELP SEARCH:\n'+a),f.error=!0,f.messageError='ERROR ON PROCESSING REQUEST TO YELP SERVER: '+a,h(f)}})};